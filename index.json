{"repository_name":"chatgpt-cli","body":"# ChatGPT CLI\n\n[![build](https://github.com/kojix2/chatgpt-cli/actions/workflows/build.yml/badge.svg)](https://github.com/kojix2/chatgpt-cli/actions/workflows/build.yml)\n\nChatGPT CLI is a command-line interface tool for interacting with OpenAI's [ChatGPT API](https://platform.openai.com/docs/api-reference/chat). It allows users to communicate with the GPT model, adjust API parameters, use magic commands, insert file contents, fetch content from URLs, and execute system commands while chatting.\n\n## Features\n\n- Interact with OpenAI's ChatGPT API through a command-line interface\n- Set API parameters like model name (`gpt-3.5-turbo` by default), temperature, and top_p\n- Select pre-registered system messages with ID\n- Execute magic commands for various actions (e.g., modifying the system message, saving messages, debugging)\n- Execute system commands while chatting\n- Fetch file contents from paths and insert them into the chat\n- Fetch contents from URLs and insert them into the chat\n\n## Installation\n\n1. Install [Crystal](https://github.com/crystal-lang/crystal)\n2. Build the project:\n\n   ```bash\n   git clone https://github.com/kojix2/chatgpt-cli\n   cd chatgpt-cli\n   make\n   sudo make install\n   ```\n\n3. Set your [OpenAI API key](https://platform.openai.com/account/api-keys) as an environment variable:\n\n   ```bash\n   export OPENAI_API_KEY=\"your_openai_api_key\"\n   ```\n\n## Usage\n\nTo start using ChatGPT CLI, run the `chatgpt` command in your terminal:\n\n```bash\nchatgpt\n```\n\nType a message and press Enter to get a response from GPT-3.5 Turbo. To exit, type `exit`, `quit`, or press `Ctrl + D`.\n\n### Options\n\nYou can set various options when running the `chatgpt` command:\n\n```\nUsage: bin/chatgpt [options]\n    -m MODEL, --model MODEL          Model name [gpt-3.5-turbo]\n    -i ID, --id ID                   ID of the custom system message\n    -s STR, --system STR             System message\n    -n INT                           Number of edits to generate [1]\n    -t Float, --temperature Float    Sampling temperature to use [1.0]\n    -p Float, --top_p Float          Probability threshold of nucleus sampling [1.0]\n    -v, --version                    Print version info and exit\n    -h, --help                       Print help\n```\n\n### Select a pre-defined system command\n\n```bash\nchatgpt -i code\n```\n\nTo add or remove system commands, see the CONFIGURATION section.\n\n### File Insertion with %{}\n\nYou can insert the contents of a file into the chat by enclosing the file path in `%{}`. For example, to insert the contents of a file called `example.py` located in the `src` directory, use `%{src/example.py}`.\n\n```\n> Please explain what the following code does. Are there any bugs? %{src/example.py}\n```\n\n```\n> Please read the code of the tool: %{src/**/*} Then update README.md %{README.md}\n...\n> %w README.md\n```\n\n### Web Page Insertion with %%{} (experimental)\n\nYou can insert the contents of a web page.\n\n```\n> Please choose five interesting topics from %%{https://news.ycombinator.com/}\n```\n\nHere the HTML from the URL is fetched, the words used in the `body` are extracted and passed to ChatGPT. It is much smaller than the raw HTML, but still not enough.\n\n### Magic Commands\n\nWithin the CLI, you can use magic commands to perform various actions:\n\n- `%clear` : Clear all messages\n- `%undo <n>` : Undo last query and response [1]\n- `%write <filename>`: Write the most recent message to a specified file\n- `%w <filename>`: Alias for `write`\n- `%config`: Edit config file\n- `%system`: Show the current system message\n- `%system <message>`: Set a new system message\n- `%resume` : Load data from auto saved data file\n- `%edit`: Edit data in JSON format\n- `%save <filename>`: Save data to a file [`chatgpt.json`]\n- `%load <filename>`: Load data from a file [`chatgpt.json`]\n- `%token(s)`: Total tokens used\n- `%debug`: Toggle debug mode\n- `%help`: Show the help\n\nNote that for `%config`, `%data`, and other commands that launch an editor, the editor used can be set by the `EDITOR` environment variable. The default editor is `vim`.\n\nThe tool is under development, and the magic commands are still being improved.\n\n### Executing System Commands\n\nYou can execute system commands while chatting by prefixing the command with the `!` symbol. For example, to check the current working directory, type `!pwd` and press Enter. Similarly, you can execute other system commands like `!ls`, `!date`, etc. If you want to execute a command and record its output for later use, you can prefix the command with `!!` instead, then use `%STDOUT` or `%STDERR` to insert the captured output into the chat.\n\n#### Examples:\n\n1. Execute a command, and display the output immediately:\n\n```bash\n> !pwd\n> !vim\n> !htop\n```\n\n2. Capture the output of a command for later use:\n\n```bash\n> !! git diff\n... git diff output ...\n> Please write commit message: %STDOUT\n```\n\n```bash\n> !!wrong_command\n> Explain the meaning of this error message: %STDERR\n```\n\n#### Execute code blocks captured from markdown in the response\n\nWhen ChatGPT returns code blocks enclosed with triple backticks, ChatGPT CLI saves these blocks temporarily and assigns them to environment variables named `CODE1`, `CODE2`, ... and so on in sequential order. This allows you to execute the code blocks by referencing the environment variables in a system command. For example, if the response contains Python, Ruby, and Bash code blocks, you can execute them using `$CODE1`, `$CODE2`, and `$CODE3`, respectively.\n\n````md\n> Write code to display 1 to 10 in Python and Ruby.\n> Python:\n\n```\nfor i in range(1, 11):\n    print(i)\n```\n\nRuby:\n\n```\n(1..10).each { |i| puts i }\n```\n\n> ! python $CODE1\n> ! ruby $CODE2\n````\n\n## Configuration\n\nThe system messages used by ChatGPT CLI can be customized through the `config.json` file. The file is located in `~/.config/chatgpt-cli/` by default, but it can be changed by setting the `CHATGPT_CLI_CONFIG` environment variable.\n\nThe `config.json` file has the following structure:\n\n```json\n{\n  \"system_messages\": {\n    \"tran\": {\n      \"role\": \"system\",\n      \"content\": \"I want you to act as a translator, spelling corrector, and improver.\"\n    },\n    \"code\": {\n      \"role\": \"system\",\n      \"content\": \"I want you to act as a programmer, writing code.\"\n    },\n    \"poet\": {\n      \"role\": \"system\",\n      \"content\": \"I want you to act as a poet, writing poetry.\"\n    }\n  }\n}\n```\n\n## Uninstallation\n\n```sh\nrm /usr/local/bin/chatgpt   # Remove the executable\nrm -r ~/.config/chatgpt-cli # Remove the config directory\nrm ~/.chatgpt_history       # Remove command history\n```\n\n## Contributing\n\nBug reports and pull requests are welcome on GitHub at [https://github.com/kojix2/chatgpt-cli](https://github.com/kojix2/chatgpt-cli).\n\n## Development\n\n```bash\ngit clone https://github.com/kojix2/chatgpt-cli\ncd chatgpt-cli\nshards install\nshards build --release\nbin/chatgpt\n```\n\n## License\n\nThis project is open-source and available under the terms of the [MIT License](https://opensource.org/licenses/MIT).\n","program":{"html_id":"chatgpt-cli/toplevel","path":"toplevel.html","kind":"module","full_name":"Top Level Namespace","name":"Top Level Namespace","abstract":false,"locations":[],"repository_name":"chatgpt-cli","program":true,"enum":false,"alias":false,"const":false,"class_methods":[{"html_id":"words(parser)-class-method","name":"words","abstract":false,"args":[{"name":"parser","external_name":"parser","restriction":""}],"args_string":"(parser)","args_html":"(parser)","location":{"filename":"src/chatgpt/webpage_compressor.cr","line_number":7,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/webpage_compressor.cr#L7"},"def":{"name":"words","args":[{"name":"parser","external_name":"parser","restriction":""}],"visibility":"Public","body":"(parser.nodes(:_text)).select do |__arg0|\n  __arg0.parents.all?(&.displayble?)\nend.map(&.tag_text).reject(&.blank?).map do |__arg4|\n  __arg4.strip.gsub(/\\s{2,}/, \" \")\nend"}}],"types":[{"html_id":"chatgpt-cli/ChatGPT","path":"ChatGPT.html","kind":"module","full_name":"ChatGPT","name":"ChatGPT","abstract":false,"locations":[{"filename":"src/chatgpt.cr","line_number":3,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt.cr#L3"},{"filename":"src/chatgpt/cli.cr","line_number":18,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/cli.cr#L18"},{"filename":"src/chatgpt/cli/parser.cr","line_number":5,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/cli/parser.cr#L5"},{"filename":"src/chatgpt/cli/version.cr","line_number":1,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/cli/version.cr#L1"},{"filename":"src/chatgpt/client.cr","line_number":3,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/client.cr#L3"},{"filename":"src/chatgpt/config.cr","line_number":3,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/config.cr#L3"},{"filename":"src/chatgpt/file_extensions.cr","line_number":1,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/file_extensions.cr#L1"},{"filename":"src/chatgpt/input_substitutor.cr","line_number":3,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/input_substitutor.cr#L3"},{"filename":"src/chatgpt/magic_command_runner.cr","line_number":3,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L3"},{"filename":"src/chatgpt/post_data.cr","line_number":3,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/post_data.cr#L3"},{"filename":"src/chatgpt/system_command_runner.cr","line_number":1,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/system_command_runner.cr#L1"}],"repository_name":"chatgpt-cli","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"DEBUG_FLAG","name":"DEBUG_FLAG","value":"[false]"},{"id":"FILE_EXTENSIONS","name":"FILE_EXTENSIONS","value":"{\".c\" => \"c\", \".cr\" => \"crystal\", \".cpp\" => \"cpp\", \".cs\" => \"csharp\", \".css\" => \"css\", \".go\" => \"go\", \".html\" => \"html\", \".htm\" => \"html\", \".java\" => \"java\", \".js\" => \"javascript\", \".json\" => \"json\", \".kt\" => \"kotlin\", \".lua\" => \"lua\", \".md\" => \"md\", \".markdown\" => \"markdown\", \".m\" => \"matlab\", \".nim\" => \"nim\", \".pl\" => \"perl\", \".php\" => \"php\", \".py\" => \"python\", \".R\" => \"r\", \".rb\" => \"ruby\", \".rs\" => \"rust\", \".scala\" => \"scala\", \".sh\" => \"shell\", \".sql\" => \"sql\", \".swift\" => \"swift\", \".ts\" => \"typescript\", \".xml\" => \"xml\", \".yaml\" => \"yaml\", \".yml\" => \"yaml\"}"}],"types":[{"html_id":"chatgpt-cli/ChatGPT/ApiKeyError","path":"ChatGPT/ApiKeyError.html","kind":"class","full_name":"ChatGPT::ApiKeyError","name":"ApiKeyError","abstract":false,"superclass":{"html_id":"chatgpt-cli/Exception","kind":"class","full_name":"Exception","name":"Exception"},"ancestors":[{"html_id":"chatgpt-cli/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"chatgpt-cli/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"chatgpt-cli/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/chatgpt/client.cr","line_number":4,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/client.cr#L4"}],"repository_name":"chatgpt-cli","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"chatgpt-cli/ChatGPT","kind":"module","full_name":"ChatGPT","name":"ChatGPT"}},{"html_id":"chatgpt-cli/ChatGPT/CLI","path":"ChatGPT/CLI.html","kind":"class","full_name":"ChatGPT::CLI","name":"CLI","abstract":false,"superclass":{"html_id":"chatgpt-cli/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"chatgpt-cli/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"chatgpt-cli/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/chatgpt/cli.cr","line_number":19,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/cli.cr#L19"},{"filename":"src/chatgpt/cli/parser.cr","line_number":6,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/cli/parser.cr#L6"},{"filename":"src/chatgpt/cli/version.cr","line_number":2,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/cli/version.cr#L2"}],"repository_name":"chatgpt-cli","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"SOURCE_URL","name":"SOURCE_URL","value":"\"https://github.com/kojix2/chatgpt-cli\""},{"id":"VERSION","name":"VERSION","value":"{{ (`shards version /home/runner/work/chatgpt-cli/chatgpt-cli/src/chatgpt/cli`).chomp.stringify }}"}],"namespace":{"html_id":"chatgpt-cli/ChatGPT","kind":"module","full_name":"ChatGPT","name":"ChatGPT"},"constructors":[{"html_id":"new-class-method","name":"new","abstract":false,"location":{"filename":"src/chatgpt/cli.cr","line_number":27,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/cli.cr#L27"},"def":{"name":"new","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"html_id":"chat_gpt_client:ChatGPT::Client-instance-method","name":"chat_gpt_client","abstract":false,"location":{"filename":"src/chatgpt/cli.cr","line_number":21,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/cli.cr#L21"},"def":{"name":"chat_gpt_client","visibility":"Public","body":"@chat_gpt_client"}},{"html_id":"code_blocks:Array(File)-instance-method","name":"code_blocks","abstract":false,"location":{"filename":"src/chatgpt/cli.cr","line_number":25,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/cli.cr#L25"},"def":{"name":"code_blocks","return_type":"Array(File)","visibility":"Public","body":"@code_blocks"}},{"html_id":"code_blocks=(code_blocks:Array(File))-instance-method","name":"code_blocks=","abstract":false,"args":[{"name":"code_blocks","external_name":"code_blocks","restriction":"Array(File)"}],"args_string":"(code_blocks : Array(File))","args_html":"(code_blocks : Array(File))","location":{"filename":"src/chatgpt/cli.cr","line_number":25,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/cli.cr#L25"},"def":{"name":"code_blocks=","args":[{"name":"code_blocks","external_name":"code_blocks","restriction":"Array(File)"}],"visibility":"Public","body":"@code_blocks = code_blocks"}},{"html_id":"magic_command_runner:ChatGPT::MagicCommandRunner-instance-method","name":"magic_command_runner","abstract":false,"location":{"filename":"src/chatgpt/cli.cr","line_number":23,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/cli.cr#L23"},"def":{"name":"magic_command_runner","visibility":"Public","body":"@magic_command_runner"}},{"html_id":"post_data:PostData-instance-method","name":"post_data","abstract":false,"location":{"filename":"src/chatgpt/cli.cr","line_number":20,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/cli.cr#L20"},"def":{"name":"post_data","return_type":"PostData","visibility":"Public","body":"@post_data"}},{"html_id":"run-instance-method","name":"run","abstract":false,"location":{"filename":"src/chatgpt/cli.cr","line_number":49,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/cli.cr#L49"},"def":{"name":"run","visibility":"Public","body":"total_tokens = 0\nmessage_count = 0\nresponse_data = nil\nloop do\n  message_count = post_data.messages.count do |msg|\n    msg[\"role\"] == \"user\"\n  end + 1\n  LibReadline.read_history(Config::HISTORY_FILE)\n  input_msg = Readline.readline(\"#{post_data.model}:#{total_tokens}:#{message_count}> \", true)\n  if input_msg.nil?\n    break\n  end\n  if input_msg.empty?\n    next\n  end\n  File.open(Config::HISTORY_FILE, \"a\") do |f|\n    f.puts(input_msg)\n  end\n  if [\"exit\", \"quit\"].includes?(input_msg)\n    break\n  end\n  if system_command_runner.try_run(input_msg)\n    next\n  end\n  if magic_command_runner.try_run(input_msg, post_data, response_data.to_pretty_json)\n    @post_data = magic_command_runner.data\n    if magic_command_runner.next?\n      next\n    end\n  end\n  input_msg = substitutor.stdout(input_msg, /%STDOUT/)\n  input_msg = substitutor.stderr(input_msg, /%STDERR/)\n  input_msg = substitutor.url(input_msg, /%%\\{(.+?)\\}/)\n  input_msg = substitutor.file(input_msg, /%\\{(.+?)\\}/)\n  post_data.messages << {\"role\" => \"user\", \"content\" => input_msg}\n  begin\n    response = chat_gpt_client.send_chat_request(post_data)\n  rescue ex\n    STDERR.puts((\"Error: #{ex.message}\".colorize(:yellow)).mode(:bold))\n    post_data.messages.pop\n    next\n  end\n  response_data = JSON.parse(response.body)\n  if response.success?\n    result_msg = (response_data.dig(\"choices\", 0, \"message\", \"content\")).to_s\n    post_data.messages << {\"role\" => \"assistant\", \"content\" => result_msg}\n    File.write(Config::POST_DATA_FILE, post_data.to_pretty_json)\n    extract_code_blocks(result_msg)\n    total_tokens = (response_data.dig(\"usage\", \"total_tokens\")).to_s.to_i\n    puts(result_msg.colorize(:green))\n  else\n    STDERR.puts((\"Error: #{response.status_code} #{response.status}\".colorize(:yellow)).mode(:bold))\n    STDERR.puts(response.body.colorize(:yellow))\n    STDERR.puts((\"Hint: try %undo, %edit, %clear, %model or %help\".colorize(:yellow)).mode(:bold))\n    post_data.messages.pop\n  end\nend\n"}},{"html_id":"substitutor:ChatGPT::InputSubstitutor-instance-method","name":"substitutor","abstract":false,"location":{"filename":"src/chatgpt/cli.cr","line_number":24,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/cli.cr#L24"},"def":{"name":"substitutor","visibility":"Public","body":"@substitutor"}},{"html_id":"system_command_runner:ChatGPT::SystemCommandRunner-instance-method","name":"system_command_runner","abstract":false,"location":{"filename":"src/chatgpt/cli.cr","line_number":22,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/cli.cr#L22"},"def":{"name":"system_command_runner","visibility":"Public","body":"@system_command_runner"}}],"types":[{"html_id":"chatgpt-cli/ChatGPT/CLI/Parser","path":"ChatGPT/CLI/Parser.html","kind":"class","full_name":"ChatGPT::CLI::Parser","name":"Parser","abstract":false,"superclass":{"html_id":"chatgpt-cli/OptionParser","kind":"class","full_name":"OptionParser","name":"OptionParser"},"ancestors":[{"html_id":"chatgpt-cli/OptionParser","kind":"class","full_name":"OptionParser","name":"OptionParser"},{"html_id":"chatgpt-cli/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"chatgpt-cli/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/chatgpt/cli/parser.cr","line_number":7,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/cli/parser.cr#L7"}],"repository_name":"chatgpt-cli","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"chatgpt-cli/ChatGPT/CLI","kind":"class","full_name":"ChatGPT::CLI","name":"CLI"},"constructors":[{"html_id":"new-class-method","name":"new","abstract":false,"location":{"filename":"src/chatgpt/cli/parser.cr","line_number":10,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/cli/parser.cr#L10"},"def":{"name":"new","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"html_id":"data:PostData-instance-method","name":"data","abstract":false,"location":{"filename":"src/chatgpt/cli/parser.cr","line_number":8,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/cli/parser.cr#L8"},"def":{"name":"data","return_type":"PostData","visibility":"Public","body":"@data"}},{"html_id":"load_session(filename)-instance-method","name":"load_session","abstract":false,"args":[{"name":"filename","external_name":"filename","restriction":""}],"args_string":"(filename)","args_html":"(filename)","location":{"filename":"src/chatgpt/cli/parser.cr","line_number":55,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/cli/parser.cr#L55"},"def":{"name":"load_session","args":[{"name":"filename","external_name":"filename","restriction":""}],"visibility":"Public","body":"begin\n  @data = PostData.from_json(File.read(filename))\nrescue\n  STDERR.puts(\"Error: Loading session failed (#{filename})\")\nend"}}]}]},{"html_id":"chatgpt-cli/ChatGPT/Client","path":"ChatGPT/Client.html","kind":"class","full_name":"ChatGPT::Client","name":"Client","abstract":false,"superclass":{"html_id":"chatgpt-cli/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"chatgpt-cli/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"chatgpt-cli/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/chatgpt/client.cr","line_number":8,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/client.cr#L8"}],"repository_name":"chatgpt-cli","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"API_ENDPOINT","name":"API_ENDPOINT","value":"\"https://api.openai.com\""}],"namespace":{"html_id":"chatgpt-cli/ChatGPT","kind":"module","full_name":"ChatGPT","name":"ChatGPT"},"constructors":[{"html_id":"new-class-method","name":"new","abstract":false,"location":{"filename":"src/chatgpt/client.cr","line_number":13,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/client.cr#L13"},"def":{"name":"new","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"html_id":"build_http_headers-instance-method","name":"build_http_headers","abstract":false,"location":{"filename":"src/chatgpt/client.cr","line_number":17,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/client.cr#L17"},"def":{"name":"build_http_headers","visibility":"Public","body":"HTTP::Headers {\"Authorization\" => \"Bearer #{fetch_api_key}\", \"Content-Type\" => \"application/json\"}"}},{"html_id":"fetch_api_key-instance-method","name":"fetch_api_key","abstract":false,"location":{"filename":"src/chatgpt/client.cr","line_number":24,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/client.cr#L24"},"def":{"name":"fetch_api_key","visibility":"Public","body":"if ENV.has_key?(\"OPENAI_API_KEY\")\n  ENV[\"OPENAI_API_KEY\"]\nelse\n  STDERR.puts((\"Error: OPENAI_API_KEY is not set. \".colorize(:yellow)).mode(:bold))\n  STDERR.puts(\"Please get your API key and set it as an environment variable.\".colorize(:yellow))\n  \"\"\nend"}},{"html_id":"post_request(request_data)-instance-method","name":"post_request","abstract":false,"args":[{"name":"request_data","external_name":"request_data","restriction":""}],"args_string":"(request_data)","args_html":"(request_data)","location":{"filename":"src/chatgpt/client.cr","line_number":49,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/client.cr#L49"},"def":{"name":"post_request","args":[{"name":"request_data","external_name":"request_data","restriction":""}],"visibility":"Public","body":"begin\n  client = HTTP::Client.new(URI.parse(API_ENDPOINT))\n  Signal::INT.trap do |s|\n    client.close\n  end\n  response = client.post(\"/v1/chat/completions\", headers: @http_headers, body: request_data.to_json)\nrescue ex\n  Signal::INT.reset\n  raise(ex)\nend"}},{"html_id":"send_chat_request(request_data)-instance-method","name":"send_chat_request","abstract":false,"args":[{"name":"request_data","external_name":"request_data","restriction":""}],"args_string":"(request_data)","args_html":"(request_data)","location":{"filename":"src/chatgpt/client.cr","line_number":34,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/client.cr#L34"},"def":{"name":"send_chat_request","args":[{"name":"request_data","external_name":"request_data","restriction":""}],"visibility":"Public","body":"if debug_mode?\n  log_request_data(request_data)\nend\nspinner = create_spinner\nspinner.start\nbegin\n  chat_response = post_request(request_data)\nrescue ex\n  spinner.stop\n  raise(ex)\nend\nspinner.stop\nif debug_mode?\n  log_response_data(chat_response)\nend\nchat_response\n"}}]},{"html_id":"chatgpt-cli/ChatGPT/Config","path":"ChatGPT/Config.html","kind":"class","full_name":"ChatGPT::Config","name":"Config","abstract":false,"superclass":{"html_id":"chatgpt-cli/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"chatgpt-cli/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"chatgpt-cli/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/chatgpt/config.cr","line_number":4,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/config.cr#L4"}],"repository_name":"chatgpt-cli","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"BASE_DIR","name":"BASE_DIR","value":"if ENV.has_key?(\"CHATGPT_CLI_CONFIG\")\n  ENV[\"CHATGPT_CLI_CONFIG\"]\nelse\n  \"#{ENV[\"HOME\"]}/.config/chatgpt-cli\"\nend"},{"id":"CONFIG_FILE","name":"CONFIG_FILE","value":"\"#{BASE_DIR}/config.json\""},{"id":"HISTORY_FILE","name":"HISTORY_FILE","value":"\"#{ENV[\"HOME\"]}/.chatgpt_history\""},{"id":"POST_DATA_FILE","name":"POST_DATA_FILE","value":"\"#{BASE_DIR}/post_data.json\""}],"namespace":{"html_id":"chatgpt-cli/ChatGPT","kind":"module","full_name":"ChatGPT","name":"ChatGPT"},"constructors":[{"html_id":"new-class-method","name":"new","abstract":false,"location":{"filename":"src/chatgpt/config.cr","line_number":19,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/config.cr#L19"},"def":{"name":"new","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"html_id":"add_message(id,role,content)-instance-method","name":"add_message","abstract":false,"args":[{"name":"id","external_name":"id","restriction":""},{"name":"role","external_name":"role","restriction":""},{"name":"content","external_name":"content","restriction":""}],"args_string":"(id, role, content)","args_html":"(id, role, content)","location":{"filename":"src/chatgpt/config.cr","line_number":53,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/config.cr#L53"},"def":{"name":"add_message","args":[{"name":"id","external_name":"id","restriction":""},{"name":"role","external_name":"role","restriction":""},{"name":"content","external_name":"content","restriction":""}],"visibility":"Public","body":"config_data[\"system_messages\"][id] = {\"role\" => role.to_s, \"content\" => content.to_s}"}},{"html_id":"add_system_message(id,content)-instance-method","name":"add_system_message","abstract":false,"args":[{"name":"id","external_name":"id","restriction":""},{"name":"content","external_name":"content","restriction":""}],"args_string":"(id, content)","args_html":"(id, content)","location":{"filename":"src/chatgpt/config.cr","line_number":60,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/config.cr#L60"},"def":{"name":"add_system_message","args":[{"name":"id","external_name":"id","restriction":""},{"name":"content","external_name":"content","restriction":""}],"visibility":"Public","body":"add_message(id, \"system\", content)"}},{"html_id":"config_data:ConfigData-instance-method","name":"config_data","abstract":false,"location":{"filename":"src/chatgpt/config.cr","line_number":17,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/config.cr#L17"},"def":{"name":"config_data","return_type":"ConfigData","visibility":"Public","body":"@config_data"}},{"html_id":"create_default_config-instance-method","name":"create_default_config","abstract":false,"location":{"filename":"src/chatgpt/config.cr","line_number":41,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/config.cr#L41"},"def":{"name":"create_default_config","visibility":"Public","body":"add_system_message(\"edit\", \"I want you to act as an editor, grammar corrector, and improver.\")\nadd_system_message(\"code\", \"I want you to act as a programmer, writing code.\")\nadd_system_message(\"tran\", \"I want you to act as an translator, spelling corrector, and improver.\")\nadd_system_message(\"poet\", \"I want you to act as a poet, writing poetry.\")\nsave\n"}},{"html_id":"load_config-instance-method","name":"load_config","abstract":false,"location":{"filename":"src/chatgpt/config.cr","line_number":25,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/config.cr#L25"},"def":{"name":"load_config","visibility":"Public","body":"if File.exists?(CONFIG_FILE)\n  begin\n    File.open(CONFIG_FILE) do |f|\n      @config_data = ConfigData.from_json(f)\n    end\n  rescue ex\n    STDERR.puts(\"Error: #{ex}\".colorize(:red))\n    STDERR.puts(\"Failed to load config at #{CONFIG_FILE}\")\n    STDERR.puts(\"Please type %config and check the config file.\")\n  end\nelse\n  create_default_config\nend"}},{"html_id":"save-instance-method","name":"save","abstract":false,"location":{"filename":"src/chatgpt/config.cr","line_number":64,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/config.cr#L64"},"def":{"name":"save","visibility":"Public","body":"overwrite = File.exists?(CONFIG_FILE)\nFile.write(CONFIG_FILE, config_data.to_pretty_json)\nSTDERR.puts(\"#{overwrite ? \"Overwrote\" : \"Created\"} config at #{CONFIG_FILE}\")\n"}},{"html_id":"select_id(id)-instance-method","name":"select_id","abstract":false,"args":[{"name":"id","external_name":"id","restriction":""}],"args_string":"(id)","args_html":"(id)","location":{"filename":"src/chatgpt/config.cr","line_number":49,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/config.cr#L49"},"def":{"name":"select_id","args":[{"name":"id","external_name":"id","restriction":""}],"visibility":"Public","body":"(@config_data.dig(\"system_messages\", id)).as(Hash(String, String))"}}],"types":[{"html_id":"chatgpt-cli/ChatGPT/Config/ConfigData","path":"ChatGPT/Config/ConfigData.html","kind":"alias","full_name":"ChatGPT::Config::ConfigData","name":"ConfigData","abstract":false,"locations":[{"filename":"src/chatgpt/config.cr","line_number":15,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/config.cr#L15"}],"repository_name":"chatgpt-cli","program":false,"enum":false,"alias":true,"aliased":"Hash(String, Hash(String, Hash(String, String)))","aliased_html":"Hash(String, Hash(String, Hash(String, String)))","const":false,"namespace":{"html_id":"chatgpt-cli/ChatGPT/Config","kind":"class","full_name":"ChatGPT::Config","name":"Config"}}]},{"html_id":"chatgpt-cli/ChatGPT/InputSubstitutor","path":"ChatGPT/InputSubstitutor.html","kind":"class","full_name":"ChatGPT::InputSubstitutor","name":"InputSubstitutor","abstract":false,"superclass":{"html_id":"chatgpt-cli/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"chatgpt-cli/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"chatgpt-cli/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/chatgpt/input_substitutor.cr","line_number":4,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/input_substitutor.cr#L4"}],"repository_name":"chatgpt-cli","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"chatgpt-cli/ChatGPT","kind":"module","full_name":"ChatGPT","name":"ChatGPT"},"constructors":[{"html_id":"new(system_command_runner:SystemCommandRunner)-class-method","name":"new","abstract":false,"args":[{"name":"system_command_runner","external_name":"system_command_runner","restriction":"SystemCommandRunner"}],"args_string":"(system_command_runner : SystemCommandRunner)","args_html":"(system_command_runner : <a href=\"../ChatGPT/SystemCommandRunner.html\">SystemCommandRunner</a>)","location":{"filename":"src/chatgpt/input_substitutor.cr","line_number":5,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/input_substitutor.cr#L5"},"def":{"name":"new","args":[{"name":"system_command_runner","external_name":"system_command_runner","restriction":"SystemCommandRunner"}],"visibility":"Public","body":"_ = allocate\n_.initialize(system_command_runner)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"html_id":"file(input_msg,file_pattern)-instance-method","name":"file","abstract":false,"args":[{"name":"input_msg","external_name":"input_msg","restriction":""},{"name":"file_pattern","external_name":"file_pattern","restriction":""}],"args_string":"(input_msg, file_pattern)","args_html":"(input_msg, file_pattern)","location":{"filename":"src/chatgpt/input_substitutor.cr","line_number":46,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/input_substitutor.cr#L46"},"def":{"name":"file","args":[{"name":"input_msg","external_name":"input_msg","restriction":""},{"name":"file_pattern","external_name":"file_pattern","restriction":""}],"visibility":"Public","body":"input_msg.gsub(file_pattern) do |file_match|\n  file_pattern = $~[1].strip\n  formatted_file_contents = get_formatted_file_contents(file_match, file_pattern)\n  if formatted_file_contents.is_a?(Array)\n    formatted_file_contents.join(\"\\n\")\n  else\n    formatted_file_contents\n  end\nend"}},{"html_id":"stderr(input_msg,stderr_pattern)-instance-method","name":"stderr","abstract":false,"args":[{"name":"input_msg","external_name":"input_msg","restriction":""},{"name":"stderr_pattern","external_name":"stderr_pattern","restriction":""}],"args_string":"(input_msg, stderr_pattern)","args_html":"(input_msg, stderr_pattern)","location":{"filename":"src/chatgpt/input_substitutor.cr","line_number":32,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/input_substitutor.cr#L32"},"def":{"name":"stderr","args":[{"name":"input_msg","external_name":"input_msg","restriction":""},{"name":"stderr_pattern","external_name":"stderr_pattern","restriction":""}],"visibility":"Public","body":"input_msg.gsub(stderr_pattern) do |stderr_match|\n  \"\\ncommand: `#{last_command}`\\n\\n```\\n#{last_stderr}\\n```\\n\"\nend"}},{"html_id":"stdout(input_msg,stdout_pattern)-instance-method","name":"stdout","abstract":false,"args":[{"name":"input_msg","external_name":"input_msg","restriction":""},{"name":"stdout_pattern","external_name":"stdout_pattern","restriction":""}],"args_string":"(input_msg, stdout_pattern)","args_html":"(input_msg, stdout_pattern)","location":{"filename":"src/chatgpt/input_substitutor.cr","line_number":20,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/input_substitutor.cr#L20"},"def":{"name":"stdout","args":[{"name":"input_msg","external_name":"input_msg","restriction":""},{"name":"stdout_pattern","external_name":"stdout_pattern","restriction":""}],"visibility":"Public","body":"input_msg.gsub(stdout_pattern) do |stdout_match|\n  \"\\n```\\n#{last_stdout}\\n```\\n\"\nend"}},{"html_id":"url(input_msg,url_pattern)-instance-method","name":"url","abstract":false,"args":[{"name":"input_msg","external_name":"input_msg","restriction":""},{"name":"url_pattern","external_name":"url_pattern","restriction":""}],"args_string":"(input_msg, url_pattern)","args_html":"(input_msg, url_pattern)","location":{"filename":"src/chatgpt/input_substitutor.cr","line_number":58,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/input_substitutor.cr#L58"},"def":{"name":"url","args":[{"name":"input_msg","external_name":"input_msg","restriction":""},{"name":"url_pattern","external_name":"url_pattern","restriction":""}],"visibility":"Public","body":"input_msg.gsub(url_pattern) do |url_match|\n  url_pattern = $~[1].strip\n  fetch_and_compress_url_contents(url_match, url_pattern)\nend"}}]},{"html_id":"chatgpt-cli/ChatGPT/MagicCommandRunner","path":"ChatGPT/MagicCommandRunner.html","kind":"class","full_name":"ChatGPT::MagicCommandRunner","name":"MagicCommandRunner","abstract":false,"superclass":{"html_id":"chatgpt-cli/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"chatgpt-cli/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"chatgpt-cli/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/chatgpt/magic_command_runner.cr","line_number":4,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L4"}],"repository_name":"chatgpt-cli","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"Table","name":"Table","value":"[{\"name\" => \"debug\", \"description\" => \"Toggle debug mode\", \"pattern\" => \"debug\", \"n_args\" => 0, \"method\" => \"debug_mode_toggle\"}, {\"name\" => \"model\", \"description\" => \"Show model name\", \"pattern\" => \"model\", \"n_args\" => 0, \"method\" => \"show_model_name\"}, {\"name\" => \"model <model_name>\", \"description\" => \"Set model name\", \"pattern\" => /^model\\s+(.+)/, \"n_args\" => 1, \"method\" => \"set_model_name\"}, {\"name\" => \"system\", \"description\" => \"Show system messages\", \"pattern\" => \"system\", \"n_args\" => 0, \"method\" => \"show_system_messages\"}, {\"name\" => \"system <message>\", \"description\" => \"Set system message\", \"pattern\" => /^system\\s+(.+)/, \"n_args\" => 1, \"method\" => \"set_system_messages\"}, {\"name\" => \"edit\", \"description\" => \"Show or edit data in JSON\", \"pattern\" => \"edit\", \"n_args\" => 0, \"method\" => \"edit_data_json\"}, {\"name\" => \"clear\", \"description\" => \"Clear messages and initialize data\", \"pattern\" => \"clear\", \"n_args\" => 0, \"method\" => \"clear_messages\"}, {\"name\" => \"write <file_name> or w <file_name>\", \"description\" => \"Write last message to <file_name>\", \"pattern\" => /^[write,w]\\s+(.+)/, \"n_args\" => 1, \"method\" => \"write_to_file\"}, {\"name\" => \"undo\", \"description\" => \"Undo last message and response\", \"pattern\" => \"undo\", \"n_args\" => 0, \"method\" => \"undo\"}, {\"name\" => \"undo <n>\", \"description\" => \"Undo last <n> messages and responses\", \"pattern\" => /^undo\\s+(\\d+)/, \"n_args\" => 1, \"method\" => \"undo\"}, {\"name\" => \"resume\", \"description\" => \"Resume from auto-saved data\", \"pattern\" => \"resume\", \"n_args\" => 0, \"method\" => \"resume\"}, {\"name\" => \"save\", \"description\" => \"Save data to chatgpt-<timestamp>.json\", \"pattern\" => \"save\", \"n_args\" => 0, \"method\" => \"save_data_to_json\"}, {\"name\" => \"save <file_name>\", \"description\" => \"Save data to <file_name>\", \"pattern\" => /^save\\s+(.+)/, \"n_args\" => 1, \"method\" => \"save_data_to_json\"}, {\"name\" => \"load\", \"description\" => \"Load latest saved data from current directory\", \"pattern\" => \"load\", \"n_args\" => 0, \"method\" => \"load_data_from_json\"}, {\"name\" => \"load <file_name>\", \"description\" => \"Load data from <file_name>\", \"pattern\" => /^load\\s+(.+)/, \"n_args\" => 1, \"method\" => \"load_data_from_json\"}, {\"name\" => \"config\", \"description\" => \"Edit config file\", \"pattern\" => \"config\", \"n_args\" => 0, \"method\" => \"show_config\"}, {\"name\" => \"response\", \"description\" => \"Show last response in JSON\", \"pattern\" => \"response\", \"n_args\" => 0, \"method\" => \"show_response_json\"}, {\"name\" => \"tokens\", \"description\" => \"Show total tokens used\", \"pattern\" => /^tokens?\\s*$/, \"n_args\" => 0, \"method\" => \"show_total_tokens\"}, {\"name\" => \"history\", \"description\" => \"Show history\", \"pattern\" => \"history\", \"n_args\" => 0, \"method\" => \"show_history\"}, {\"name\" => \"help\", \"description\" => \"Show this help\", \"pattern\" => \"help\", \"n_args\" => 0, \"method\" => \"show_help\"}]"}],"namespace":{"html_id":"chatgpt-cli/ChatGPT","kind":"module","full_name":"ChatGPT","name":"ChatGPT"},"constructors":[{"html_id":"new(data=nil,key:String=\"%\")-class-method","name":"new","abstract":false,"args":[{"name":"data","default_value":"nil","external_name":"data","restriction":""},{"name":"key","default_value":"\"%\"","external_name":"key","restriction":"::String"}],"args_string":"(data = nil, key : String = \"%\")","args_html":"(data = <span class=\"n\">nil</span>, key : String = <span class=\"s\">&quot;%&quot;</span>)","location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":153,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L153"},"def":{"name":"new","args":[{"name":"data","default_value":"nil","external_name":"data","restriction":""},{"name":"key","default_value":"\"%\"","external_name":"key","restriction":"::String"}],"visibility":"Public","body":"_ = allocate\n_.initialize(data, key)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"html_id":"clear_messages-instance-method","name":"clear_messages","abstract":false,"location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":244,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L244"},"def":{"name":"clear_messages","visibility":"Public","body":"data.messages.clear\nputs(\"Cleared\".colorize(:yellow))\ntrue\n"}},{"html_id":"data:PostData-instance-method","name":"data","abstract":false,"location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":150,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L150"},"def":{"name":"data","return_type":"PostData","visibility":"Public","body":"@data"}},{"html_id":"data=(data:PostData)-instance-method","name":"data=","abstract":false,"args":[{"name":"data","external_name":"data","restriction":"PostData"}],"args_string":"(data : PostData)","args_html":"(data : <a href=\"../ChatGPT/PostData.html\">PostData</a>)","location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":150,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L150"},"def":{"name":"data=","args":[{"name":"data","external_name":"data","restriction":"PostData"}],"visibility":"Public","body":"@data = data"}},{"html_id":"debug_mode_toggle-instance-method","name":"debug_mode_toggle","abstract":false,"location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":190,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L190"},"def":{"name":"debug_mode_toggle","visibility":"Public","body":"DEBUG_FLAG[0] = !DEBUG_FLAG[0]\nputs(\"Debug mode: #{DEBUG_FLAG[0]}\".colorize(:yellow))\ntrue\n"}},{"html_id":"edit_data_json-instance-method","name":"edit_data_json","abstract":false,"location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":228,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L228"},"def":{"name":"edit_data_json","visibility":"Public","body":"new_data = data\n(File.tempfile(\"chatgpt-cli\", \".json\") do |file|\n  File.write(file.path, data.to_pretty_json)\n  open_editor(file.path)\n  begin\n    new_data = PostData.from_json(File.read(file.path))\n    puts(\"Saved\".colorize(:yellow))\n  rescue\n    puts((\"Error: Invalid JSON\".colorize(:yellow)).mode(:bold))\n  end\nend).delete\n@data = new_data\ntrue\n"}},{"html_id":"key:String-instance-method","name":"key","abstract":false,"location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":149,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L149"},"def":{"name":"key","return_type":"String","visibility":"Public","body":"@key"}},{"html_id":"load_data_from_json(file_name)-instance-method","name":"load_data_from_json","abstract":false,"args":[{"name":"file_name","external_name":"file_name","restriction":""}],"args_string":"(file_name)","args_html":"(file_name)","location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":296,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L296"},"def":{"name":"load_data_from_json","args":[{"name":"file_name","external_name":"file_name","restriction":""}],"visibility":"Public","body":"begin\n  new_data = PostData.from_json(File.read(file_name))\n  @data = new_data\n  puts(\"Loaded from #{file_name}\".colorize(:yellow))\nrescue\n  puts((\"Error: Invalid JSON\".colorize(:yellow)).mode(:bold))\nend\ntrue\n"}},{"html_id":"load_data_from_json-instance-method","name":"load_data_from_json","abstract":false,"location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":286,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L286"},"def":{"name":"load_data_from_json","visibility":"Public","body":"file_names = Dir.glob(\"chatgpt-*.json\")\nif file_names.empty?\n  puts((\"Error: No saved data\".colorize(:yellow)).mode(:bold))\n  return true\nend\nload_data_from_json(file_names.sort.last)\ntrue\n"}},{"html_id":"next?:Bool-instance-method","name":"next?","abstract":false,"location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":169,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L169"},"def":{"name":"next?","visibility":"Public","body":"@next"}},{"html_id":"response_data:String-instance-method","name":"response_data","abstract":false,"location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":151,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L151"},"def":{"name":"response_data","return_type":"String","visibility":"Public","body":"@response_data"}},{"html_id":"resume-instance-method","name":"resume","abstract":false,"location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":250,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L250"},"def":{"name":"resume","visibility":"Public","body":"if File.exists?(Config::POST_DATA_FILE)\n  load_data_from_json(Config::POST_DATA_FILE)\nelse\n  puts(\"No saved data\".colorize(:yellow))\nend\ntrue\n"}},{"html_id":"run(command:String,data:ChatGPT::PostData,response_data:String):Bool-instance-method","name":"run","abstract":false,"args":[{"name":"command","external_name":"command","restriction":"String"},{"name":"data","external_name":"data","restriction":"::ChatGPT::PostData"},{"name":"response_data","external_name":"response_data","restriction":"::String"}],"args_string":"(command : String, data : ChatGPT::PostData, response_data : String) : Bool","args_html":"(command : String, data : <a href=\"../ChatGPT/PostData.html\">ChatGPT::PostData</a>, response_data : String) : Bool","location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":173,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L173"},"def":{"name":"run","args":[{"name":"command","external_name":"command","restriction":"String"},{"name":"data","external_name":"data","restriction":"::ChatGPT::PostData"},{"name":"response_data","external_name":"response_data","restriction":"::String"}],"return_type":"Bool","visibility":"Public","body":"@data = data\n@response_data = response_data\n{% if true %}\n      case command\n      {% for value in Table %}\n        when {{ value[\"pattern\"] }}\n        {% if value[\"n_args\"] == 0 %}\n          {{ value[\"method\"].id }}\n        {% else %}\n          {{ value[\"method\"].id }}($1)\n        {% end %}\n      {% end %}\n      else\n        unknown_command_error(command)\n      end\n      {% end %}\n"}},{"html_id":"save_data_to_json(file_name)-instance-method","name":"save_data_to_json","abstract":false,"args":[{"name":"file_name","external_name":"file_name","restriction":""}],"args_string":"(file_name)","args_html":"(file_name)","location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":280,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L280"},"def":{"name":"save_data_to_json","args":[{"name":"file_name","external_name":"file_name","restriction":""}],"visibility":"Public","body":"File.write(file_name, data.to_json)\nputs(\"Saved to #{file_name}\".colorize(:yellow))\ntrue\n"}},{"html_id":"save_data_to_json-instance-method","name":"save_data_to_json","abstract":false,"location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":273,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L273"},"def":{"name":"save_data_to_json","visibility":"Public","body":"timestamp = Time.local.to_s(\"%Y%m%d-%H%M%S\")\nfile_name = \"chatgpt-#{timestamp}.json\"\nsave_data_to_json(file_name)\ntrue\n"}},{"html_id":"set_model_name(model_name)-instance-method","name":"set_model_name","abstract":false,"args":[{"name":"model_name","external_name":"model_name","restriction":""}],"args_string":"(model_name)","args_html":"(model_name)","location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":201,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L201"},"def":{"name":"set_model_name","args":[{"name":"model_name","external_name":"model_name","restriction":""}],"visibility":"Public","body":"data.model = model_name\nputs(\"Set model to #{model_name}\".colorize(:yellow))\ntrue\n"}},{"html_id":"set_system_messages(message)-instance-method","name":"set_system_messages","abstract":false,"args":[{"name":"message","external_name":"message","restriction":""}],"args_string":"(message)","args_html":"(message)","location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":216,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L216"},"def":{"name":"set_system_messages","args":[{"name":"message","external_name":"message","restriction":""}],"visibility":"Public","body":"if data.messages.empty?\n  data.messages << {\"role\" => \"system\", \"content\" => message}\nelse\n  if data.messages[0][\"role\"] == \"system\"\n    data.messages[0][\"content\"] = message\n  else\n    data.messages.unshift({\"role\" => \"system\", \"content\" => message})\n  end\nend\nputs(\"Set system message to #{message}\".colorize(:yellow))\ntrue\n"}},{"html_id":"show_config-instance-method","name":"show_config","abstract":false,"location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":337,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L337"},"def":{"name":"show_config","visibility":"Public","body":"open_editor(Config::CONFIG_FILE)\ntrue\n"}},{"html_id":"show_help-instance-method","name":"show_help","abstract":false,"location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":342,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L342"},"def":{"name":"show_help","visibility":"Public","body":"puts((\"Magic commands:\".colorize(:yellow)).mode(:bold))\nTable.each do |value|\n  puts((\"  % #{value[\"name\"]}\".colorize(:yellow)).mode(:bold))\n  puts(\"    #{value[\"description\"]}\".colorize(:yellow))\nend\ntrue\n"}},{"html_id":"show_history-instance-method","name":"show_history","abstract":false,"location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":332,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L332"},"def":{"name":"show_history","visibility":"Public","body":"open_editor(Config::HISTORY_FILE)\ntrue\n"}},{"html_id":"show_model_name-instance-method","name":"show_model_name","abstract":false,"location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":196,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L196"},"def":{"name":"show_model_name","visibility":"Public","body":"puts(\"Model: #{data.model}\".colorize(:yellow))\ntrue\n"}},{"html_id":"show_response_json-instance-method","name":"show_response_json","abstract":false,"location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":314,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L314"},"def":{"name":"show_response_json","visibility":"Public","body":"(File.tempfile(\"chatgpt-cli\", \".json\") do |file|\n  File.write(file.path, response_data)\n  open_editor(file.path)\nend).delete\ntrue\n"}},{"html_id":"show_system_messages-instance-method","name":"show_system_messages","abstract":false,"location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":207,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L207"},"def":{"name":"show_system_messages","visibility":"Public","body":"data.messages.each do |msg|\n  if msg[\"role\"] == \"system\"\n    puts(msg[\"content\"].colorize(:yellow))\n  end\nend\ntrue\n"}},{"html_id":"show_total_tokens-instance-method","name":"show_total_tokens","abstract":false,"location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":322,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L322"},"def":{"name":"show_total_tokens","visibility":"Public","body":"begin\n  total_tokens = (JSON.parse(response_data)).dig?(\"usage\", \"total_tokens\")\nrescue ex\n  total_tokens = \"0\"\nend\nputs(\"Total tokens used: #{total_tokens}\".colorize(:yellow))\ntrue\n"}},{"html_id":"try_run(msg,data,response_data)-instance-method","name":"try_run","abstract":false,"args":[{"name":"msg","external_name":"msg","restriction":""},{"name":"data","external_name":"data","restriction":""},{"name":"response_data","external_name":"response_data","restriction":""}],"args_string":"(msg, data, response_data)","args_html":"(msg, data, response_data)","location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":159,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L159"},"def":{"name":"try_run","args":[{"name":"msg","external_name":"msg","restriction":""},{"name":"data","external_name":"data","restriction":""},{"name":"response_data","external_name":"response_data","restriction":""}],"visibility":"Public","body":"if (/^%(?!\\{|#{key})/).match(msg)\n  cmd = msg[1..-1].strip\n  @next = run(cmd, data, response_data)\n  true\nelse\n  false\nend"}},{"html_id":"undo(n)-instance-method","name":"undo","abstract":false,"args":[{"name":"n","external_name":"n","restriction":""}],"args_string":"(n)","args_html":"(n)","location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":264,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L264"},"def":{"name":"undo","args":[{"name":"n","external_name":"n","restriction":""}],"visibility":"Public","body":"n.to_i.times do\n  data.messages.pop\n  data.messages.pop\nend\nputs(\"Undo #{n == 1 ? \"last\" : n} messages\".colorize(:yellow))\ntrue\n"}},{"html_id":"undo-instance-method","name":"undo","abstract":false,"location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":259,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L259"},"def":{"name":"undo","visibility":"Public","body":"undo(1)\ntrue\n"}},{"html_id":"unknown_command_error(command)-instance-method","name":"unknown_command_error","abstract":false,"args":[{"name":"command","external_name":"command","restriction":""}],"args_string":"(command)","args_html":"(command)","location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":351,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L351"},"def":{"name":"unknown_command_error","args":[{"name":"command","external_name":"command","restriction":""}],"visibility":"Public","body":"STDERR.puts((\"Error: Unknown magic command: #{command}\".colorize(:yellow)).mode(:bold))\ntrue\n"}},{"html_id":"write_to_file(file_name)-instance-method","name":"write_to_file","abstract":false,"args":[{"name":"file_name","external_name":"file_name","restriction":""}],"args_string":"(file_name)","args_html":"(file_name)","location":{"filename":"src/chatgpt/magic_command_runner.cr","line_number":307,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/magic_command_runner.cr#L307"},"def":{"name":"write_to_file","args":[{"name":"file_name","external_name":"file_name","restriction":""}],"visibility":"Public","body":"last_response = (data.messages.dig?(-1, \"content\")).to_s\nFile.write(file_name, last_response)\nputs(\"Writed to #{file_name}\".colorize(:yellow))\ntrue\n"}}]},{"html_id":"chatgpt-cli/ChatGPT/PostData","path":"ChatGPT/PostData.html","kind":"struct","full_name":"ChatGPT::PostData","name":"PostData","abstract":false,"superclass":{"html_id":"chatgpt-cli/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"chatgpt-cli/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"chatgpt-cli/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"chatgpt-cli/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"chatgpt-cli/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/chatgpt/post_data.cr","line_number":4,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/post_data.cr#L4"}],"repository_name":"chatgpt-cli","program":false,"enum":false,"alias":false,"const":false,"included_modules":[{"html_id":"chatgpt-cli/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"}],"namespace":{"html_id":"chatgpt-cli/ChatGPT","kind":"module","full_name":"ChatGPT","name":"ChatGPT"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/chatgpt/post_data.cr","line_number":5,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/post_data.cr#L5"},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"}},{"html_id":"new(model:String=\"gpt-3.5-turbo\",messages:Array(Hash(String,String))=[]ofHash(String,String),n:Int32=1,temperature:Float64=1.0,top_p:Float64=1.0)-class-method","name":"new","abstract":false,"args":[{"name":"model","default_value":"\"gpt-3.5-turbo\"","external_name":"model","restriction":"::String"},{"name":"messages","default_value":"[] of Hash(String, String)","external_name":"messages","restriction":"::Array(::Hash(::String, ::String))"},{"name":"n","default_value":"1","external_name":"n","restriction":"::Int32"},{"name":"temperature","default_value":"1.0","external_name":"temperature","restriction":"::Float64"},{"name":"top_p","default_value":"1.0","external_name":"top_p","restriction":"::Float64"}],"args_string":"(model : String = \"gpt-3.5-turbo\", messages : Array(Hash(String, String)) = [] of Hash(String, String), n : Int32 = 1, temperature : Float64 = 1.0, top_p : Float64 = 1.0)","args_html":"(model : String = <span class=\"s\">&quot;gpt-3.5-turbo&quot;</span>, messages : Array(Hash(String, String)) = <span class=\"o\">[]</span> <span class=\"k\">of</span> <span class=\"t\">Hash</span>(<span class=\"t\">String</span>, <span class=\"t\">String</span>), n : Int32 = <span class=\"n\">1</span>, temperature : Float64 = <span class=\"n\">1.0</span>, top_p : Float64 = <span class=\"n\">1.0</span>)","location":{"filename":"src/chatgpt/post_data.cr","line_number":12,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/post_data.cr#L12"},"def":{"name":"new","args":[{"name":"model","default_value":"\"gpt-3.5-turbo\"","external_name":"model","restriction":"::String"},{"name":"messages","default_value":"[] of Hash(String, String)","external_name":"messages","restriction":"::Array(::Hash(::String, ::String))"},{"name":"n","default_value":"1","external_name":"n","restriction":"::Int32"},{"name":"temperature","default_value":"1.0","external_name":"temperature","restriction":"::Float64"},{"name":"top_p","default_value":"1.0","external_name":"top_p","restriction":"::Float64"}],"visibility":"Public","body":"_ = allocate\n_.initialize(model, messages, n, temperature, top_p)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"html_id":"messages:Array(Hash(String,String))-instance-method","name":"messages","abstract":false,"location":{"filename":"src/chatgpt/post_data.cr","line_number":7,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/post_data.cr#L7"},"def":{"name":"messages","return_type":"Array(Hash(String, String))","visibility":"Public","body":"@messages"}},{"html_id":"messages=(messages:Array(Hash(String,String)))-instance-method","name":"messages=","abstract":false,"args":[{"name":"messages","external_name":"messages","restriction":"Array(Hash(String, String))"}],"args_string":"(messages : Array(Hash(String, String)))","args_html":"(messages : Array(Hash(String, String)))","location":{"filename":"src/chatgpt/post_data.cr","line_number":7,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/post_data.cr#L7"},"def":{"name":"messages=","args":[{"name":"messages","external_name":"messages","restriction":"Array(Hash(String, String))"}],"visibility":"Public","body":"@messages = messages"}},{"html_id":"model:String-instance-method","name":"model","abstract":false,"location":{"filename":"src/chatgpt/post_data.cr","line_number":6,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/post_data.cr#L6"},"def":{"name":"model","return_type":"String","visibility":"Public","body":"@model"}},{"html_id":"model=(model:String)-instance-method","name":"model=","abstract":false,"args":[{"name":"model","external_name":"model","restriction":"String"}],"args_string":"(model : String)","args_html":"(model : String)","location":{"filename":"src/chatgpt/post_data.cr","line_number":6,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/post_data.cr#L6"},"def":{"name":"model=","args":[{"name":"model","external_name":"model","restriction":"String"}],"visibility":"Public","body":"@model = model"}},{"html_id":"n:Int32-instance-method","name":"n","abstract":false,"location":{"filename":"src/chatgpt/post_data.cr","line_number":10,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/post_data.cr#L10"},"def":{"name":"n","return_type":"Int32","visibility":"Public","body":"@n"}},{"html_id":"n=(n:Int32)-instance-method","name":"n=","abstract":false,"args":[{"name":"n","external_name":"n","restriction":"Int32"}],"args_string":"(n : Int32)","args_html":"(n : Int32)","location":{"filename":"src/chatgpt/post_data.cr","line_number":10,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/post_data.cr#L10"},"def":{"name":"n=","args":[{"name":"n","external_name":"n","restriction":"Int32"}],"visibility":"Public","body":"@n = n"}},{"html_id":"temperature:Float64-instance-method","name":"temperature","abstract":false,"location":{"filename":"src/chatgpt/post_data.cr","line_number":8,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/post_data.cr#L8"},"def":{"name":"temperature","return_type":"Float64","visibility":"Public","body":"@temperature"}},{"html_id":"temperature=(temperature:Float64)-instance-method","name":"temperature=","abstract":false,"args":[{"name":"temperature","external_name":"temperature","restriction":"Float64"}],"args_string":"(temperature : Float64)","args_html":"(temperature : Float64)","location":{"filename":"src/chatgpt/post_data.cr","line_number":8,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/post_data.cr#L8"},"def":{"name":"temperature=","args":[{"name":"temperature","external_name":"temperature","restriction":"Float64"}],"visibility":"Public","body":"@temperature = temperature"}},{"html_id":"top_p:Float64-instance-method","name":"top_p","abstract":false,"location":{"filename":"src/chatgpt/post_data.cr","line_number":9,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/post_data.cr#L9"},"def":{"name":"top_p","return_type":"Float64","visibility":"Public","body":"@top_p"}},{"html_id":"top_p=(top_p:Float64)-instance-method","name":"top_p=","abstract":false,"args":[{"name":"top_p","external_name":"top_p","restriction":"Float64"}],"args_string":"(top_p : Float64)","args_html":"(top_p : Float64)","location":{"filename":"src/chatgpt/post_data.cr","line_number":9,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/post_data.cr#L9"},"def":{"name":"top_p=","args":[{"name":"top_p","external_name":"top_p","restriction":"Float64"}],"visibility":"Public","body":"@top_p = top_p"}}]},{"html_id":"chatgpt-cli/ChatGPT/SigIntError","path":"ChatGPT/SigIntError.html","kind":"class","full_name":"ChatGPT::SigIntError","name":"SigIntError","abstract":false,"superclass":{"html_id":"chatgpt-cli/Exception","kind":"class","full_name":"Exception","name":"Exception"},"ancestors":[{"html_id":"chatgpt-cli/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"chatgpt-cli/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"chatgpt-cli/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/chatgpt/client.cr","line_number":6,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/client.cr#L6"}],"repository_name":"chatgpt-cli","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"chatgpt-cli/ChatGPT","kind":"module","full_name":"ChatGPT","name":"ChatGPT"}},{"html_id":"chatgpt-cli/ChatGPT/SystemCommandRunner","path":"ChatGPT/SystemCommandRunner.html","kind":"class","full_name":"ChatGPT::SystemCommandRunner","name":"SystemCommandRunner","abstract":false,"superclass":{"html_id":"chatgpt-cli/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"chatgpt-cli/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"chatgpt-cli/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/chatgpt/system_command_runner.cr","line_number":2,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/system_command_runner.cr#L2"}],"repository_name":"chatgpt-cli","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"chatgpt-cli/ChatGPT","kind":"module","full_name":"ChatGPT","name":"ChatGPT"},"constructors":[{"html_id":"new-class-method","name":"new","abstract":false,"location":{"filename":"src/chatgpt/system_command_runner.cr","line_number":7,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/system_command_runner.cr#L7"},"def":{"name":"new","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"html_id":"last_command:String-instance-method","name":"last_command","abstract":false,"location":{"filename":"src/chatgpt/system_command_runner.cr","line_number":5,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/system_command_runner.cr#L5"},"def":{"name":"last_command","visibility":"Public","body":"@last_command"}},{"html_id":"last_stderr:String-instance-method","name":"last_stderr","abstract":false,"location":{"filename":"src/chatgpt/system_command_runner.cr","line_number":4,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/system_command_runner.cr#L4"},"def":{"name":"last_stderr","visibility":"Public","body":"@last_stderr"}},{"html_id":"last_stdout:String-instance-method","name":"last_stdout","abstract":false,"location":{"filename":"src/chatgpt/system_command_runner.cr","line_number":3,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/system_command_runner.cr#L3"},"def":{"name":"last_stdout","visibility":"Public","body":"@last_stdout"}},{"html_id":"try_run(input_message)-instance-method","name":"try_run","abstract":false,"args":[{"name":"input_message","external_name":"input_message","restriction":""}],"args_string":"(input_message)","args_html":"(input_message)","location":{"filename":"src/chatgpt/system_command_runner.cr","line_number":13,"url":"https://github.com/kojix2/chatgpt-cli/blob/1f9d75f52ec2a8a4b666f5d26265057636cd97f3/src/chatgpt/system_command_runner.cr#L13"},"def":{"name":"try_run","args":[{"name":"input_message","external_name":"input_message","restriction":""}],"visibility":"Public","body":"if input_message.starts_with?(\"!\")\nelse\n  return false\nend\nif input_message.starts_with?(\"!!\")\n  run(input_message[2..-1].strip, record: true)\nelse\n  run(input_message[1..-1].strip, record: false)\nend\ntrue\n"}}]}]}]}}